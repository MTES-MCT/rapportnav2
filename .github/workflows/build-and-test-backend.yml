name: "[Build & Test] Backend"

on:
  #  push:
  #    branches: [ "main" ]
  pull_request:
    branches: [ "main" ]
  workflow_dispatch:
  schedule:
    - cron: "0 3 * * *" # 3am every night

jobs:
  build-and-test-backend:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-java@v4
        with:
          distribution: temurin
          java-version: 17

      - uses: gradle/gradle-build-action@v2
        id: setup-gradle
        with:
          gradle-version: wrapper

      #      - name: Dry run
      #        run: gradle build --dry-run # just test build configuration

      - Name: Version
        run: echo "The release-candidate version was ${{ steps.setup-gradle.outputs.gradle-version }}"

      - name: "Build & test"
        run: make back-build

      #      - name: "Analyse dependencies"
      #        run: make back-check-dependencies

      #      - name: "Tests"
      #        env:
      #          CI: true
      #        run: make back-test

      #      - name: "Check clean architecture"
      #        run: make check-clean-archi

#      - name: "Build"
#        run: make back-build-mvn
